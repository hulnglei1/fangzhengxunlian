"use strict";(self["webpackChunkmilitary_simulation_training_system"]=self["webpackChunkmilitary_simulation_training_system"]||[]).push([[927],{44308:function(s,e,r){r.r(e),r.d(e,{default:function(){return d}});var t=function(){var s=this,e=s._self._c;return e("div",{staticClass:"profile-container"},[s._m(0),e("div",{staticClass:"profile-content"},[e("div",{staticClass:"info-card"},[e("div",{staticClass:"card-header"},[e("h3",[s._v("基本信息")]),s.isEditing?e("div",[e("el-button",{attrs:{type:"primary",size:"small"},on:{click:s.saveChanges}},[s._v("保存")]),e("el-button",{attrs:{size:"small"},on:{click:s.cancelEdit}},[s._v("取消")])],1):e("el-button",{attrs:{type:"text"},on:{click:s.startEdit}},[s._v("编辑")])],1),e("div",{staticClass:"info-content"},[e("el-form",{attrs:{model:s.userInfo,"label-width":"100px",disabled:!s.isEditing}},[e("el-form-item",{attrs:{label:"用户名"}},[e("el-input",{attrs:{disabled:""},model:{value:s.userInfo.username,callback:function(e){s.$set(s.userInfo,"username",e)},expression:"userInfo.username"}})],1),e("el-form-item",{attrs:{label:"姓名"}},[e("el-input",{model:{value:s.userInfo.name,callback:function(e){s.$set(s.userInfo,"name",e)},expression:"userInfo.name"}})],1),e("el-form-item",{attrs:{label:"手机号"}},[e("el-input",{model:{value:s.userInfo.phone,callback:function(e){s.$set(s.userInfo,"phone",e)},expression:"userInfo.phone"}})],1),e("el-form-item",{attrs:{label:"邮箱"}},[e("el-input",{model:{value:s.userInfo.email,callback:function(e){s.$set(s.userInfo,"email",e)},expression:"userInfo.email"}})],1)],1)],1)]),e("div",{staticClass:"info-card"},[e("div",{staticClass:"card-header"},[e("h3",[s._v("最近训练记录")]),e("el-button",{attrs:{type:"text"},on:{click:s.viewAllRecords}},[s._v("查看全部")])],1),e("div",{staticClass:"training-records"},[e("el-table",{staticStyle:{width:"100%"},attrs:{data:s.recentTrainingRecords}},[e("el-table-column",{attrs:{prop:"courseName",label:"课程名称"}}),e("el-table-column",{attrs:{prop:"date",label:"训练时间"}}),e("el-table-column",{attrs:{prop:"duration",label:"用时"}}),e("el-table-column",{attrs:{prop:"score",label:"得分"}}),e("el-table-column",{attrs:{label:"操作"},scopedSlots:s._u([{key:"default",fn:function(r){return[e("el-button",{attrs:{type:"text"},on:{click:function(e){return s.viewDetail(r.row)}}},[s._v("查看详情")])]}}])})],1)],1)]),e("div",{staticClass:"info-card"},[s._m(1),e("div",{staticClass:"password-form"},[e("el-form",{ref:"passwordForm",attrs:{model:s.passwordForm,"label-width":"100px",rules:s.passwordRules}},[e("el-form-item",{attrs:{label:"原密码",prop:"oldPassword"}},[e("el-input",{attrs:{type:"password"},model:{value:s.passwordForm.oldPassword,callback:function(e){s.$set(s.passwordForm,"oldPassword",e)},expression:"passwordForm.oldPassword"}})],1),e("el-form-item",{attrs:{label:"新密码",prop:"newPassword"}},[e("el-input",{attrs:{type:"password"},model:{value:s.passwordForm.newPassword,callback:function(e){s.$set(s.passwordForm,"newPassword",e)},expression:"passwordForm.newPassword"}})],1),e("el-form-item",{attrs:{label:"确认密码",prop:"confirmPassword"}},[e("el-input",{attrs:{type:"password"},model:{value:s.passwordForm.confirmPassword,callback:function(e){s.$set(s.passwordForm,"confirmPassword",e)},expression:"passwordForm.confirmPassword"}})],1),e("el-form-item",[e("el-button",{attrs:{type:"primary"},on:{click:s.changePassword}},[s._v("修改密码")])],1)],1)],1)])])])},a=[function(){var s=this,e=s._self._c;return e("div",{staticClass:"profile-header"},[e("h2",[s._v("个人中心")])])},function(){var s=this,e=s._self._c;return e("div",{staticClass:"card-header"},[e("h3",[s._v("修改密码")])])}],o=(r(44114),{name:"Profile",data(){const s=(s,e,r)=>{e!==this.passwordForm.newPassword?r(new Error("两次输入的密码不一致")):r()};return{isEditing:!1,userInfo:{username:"",name:"",phone:"",email:""},recentTrainingRecords:[],passwordForm:{oldPassword:"",newPassword:"",confirmPassword:""},passwordRules:{oldPassword:[{required:!0,message:"请输入原密码",trigger:"blur"}],newPassword:[{required:!0,message:"请输入新密码",trigger:"blur"},{min:6,message:"密码长度不能小于6位",trigger:"blur"}],confirmPassword:[{required:!0,message:"请确认新密码",trigger:"blur"},{validator:s,trigger:"blur"}]}}},created(){this.fetchUserInfo(),this.fetchRecentTrainingRecords()},methods:{async fetchUserInfo(){try{const s=await this.$api.getUserInfo();this.userInfo=s.data}catch(s){this.$message.error("获取用户信息失败")}},async fetchRecentTrainingRecords(){try{const s=await this.$api.getRecentTrainingRecords();this.recentTrainingRecords=s.data}catch(s){this.$message.error("获取训练记录失败")}},startEdit(){this.isEditing=!0},async saveChanges(){try{await this.$api.updateUserInfo(this.userInfo),this.$message.success("保存成功"),this.isEditing=!1}catch(s){this.$message.error("保存失败")}},cancelEdit(){this.isEditing=!1,this.fetchUserInfo()},viewAllRecords(){this.$router.push("/training-records")},viewDetail(s){this.$router.push(`/training-records/${s.id}`)},async changePassword(){try{await this.$refs.passwordForm.validate(),await this.$api.changePassword(this.passwordForm),this.$message.success("密码修改成功"),this.passwordForm={oldPassword:"",newPassword:"",confirmPassword:""}}catch(s){if(!1===s)return;this.$message.error("密码修改失败")}}}}),i=o,n=r(81656),l=(0,n.A)(i,t,a,!1,null,"4752799a",null),d=l.exports}}]);